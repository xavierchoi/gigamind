<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GigaMind — Knowledge Graph</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;500;600&family=IBM+Plex+Sans:wght@400;500;600&family=JetBrains+Mono:wght@300;400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Subtle texture overlay -->
  <div class="texture-overlay" aria-hidden="true"></div>

  <!-- Ambient background -->
  <div class="ambient-bg" aria-hidden="true">
    <div class="ambient-orb ambient-orb--1"></div>
    <div class="ambient-orb ambient-orb--2"></div>
  </div>

  <!-- Main graph canvas -->
  <svg id="graph-canvas"></svg>

  <!-- Header bar -->
  <header class="header">
    <div class="header__brand">
      <div class="header__logo">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
          <circle cx="12" cy="12" r="3" fill="currentColor"/>
          <circle cx="12" cy="12" r="8" stroke="currentColor" stroke-width="1.5" opacity="0.5"/>
          <circle cx="12" cy="12" r="11" stroke="currentColor" stroke-width="1" opacity="0.25"/>
        </svg>
      </div>
      <span class="header__title">GigaMind</span>
      <span class="header__version">v0.1.5</span>
    </div>
    <div class="header__stats">
      <div class="header__stat">
        <span class="header__stat-value" id="stat-notes">—</span>
        <span class="header__stat-label">nodes</span>
      </div>
      <div class="header__stat-divider"></div>
      <div class="header__stat">
        <span class="header__stat-value" id="stat-connections">—</span>
        <span class="header__stat-label">edges</span>
      </div>
      <div class="header__stat-divider"></div>
      <div class="header__stat header__stat--warning">
        <span class="header__stat-value" id="stat-dangling">—</span>
        <span class="header__stat-label">dangling</span>
      </div>
      <div class="header__stat-divider"></div>
      <div class="header__stat header__stat--muted">
        <span class="header__stat-value" id="stat-orphan">—</span>
        <span class="header__stat-label">orphan</span>
      </div>
    </div>
  </header>

  <!-- Command bar (search + filters) -->
  <div class="command-bar">
    <div class="search-wrapper">
      <div class="search-icon">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"/>
          <path d="M21 21l-4.35-4.35"/>
        </svg>
      </div>
      <input
        type="text"
        id="search-input"
        class="search-input"
        placeholder="Search nodes..."
        autocomplete="off"
        spellcheck="false"
      >
      <kbd class="search-shortcut">/</kbd>
      <!-- Search results dropdown -->
      <div class="search-results" id="search-results" hidden>
        <div class="search-results__header">
          <span class="search-results__count" id="search-count">0 results</span>
          <button class="search-results__clear" id="search-clear">Clear</button>
        </div>
        <ul class="search-results__list" id="search-results-list"></ul>
      </div>
    </div>

    <!-- Filter toggles -->
    <div class="filter-group">
      <button class="filter-btn filter-btn--active" data-filter="note" title="Notes">
        <span class="filter-indicator filter-indicator--note"></span>
        <span class="filter-label">Notes</span>
      </button>
      <button class="filter-btn filter-btn--active" data-filter="orphan" title="Orphan nodes">
        <span class="filter-indicator filter-indicator--orphan"></span>
        <span class="filter-label">Orphan</span>
      </button>
      <button class="filter-btn filter-btn--active" data-filter="dangling" title="Dangling references">
        <span class="filter-indicator filter-indicator--dangling"></span>
        <span class="filter-label">Dangling</span>
      </button>
    </div>

    <!-- View controls -->
    <div class="control-group">
      <button class="control-btn" id="zoom-out" title="Zoom out (-)">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="5" y1="12" x2="19" y2="12"/>
        </svg>
      </button>
      <span class="zoom-level" id="zoom-level">100%</span>
      <button class="control-btn" id="zoom-in" title="Zoom in (+)">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="12" y1="5" x2="12" y2="19"/>
          <line x1="5" y1="12" x2="19" y2="12"/>
        </svg>
      </button>
      <div class="control-divider"></div>
      <button class="control-btn" id="reset-view" title="Reset view (0)">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
          <path d="M3 3v5h5"/>
        </svg>
      </button>
      <button class="control-btn" id="toggle-labels" title="Toggle labels">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M4 7V4h16v3"/>
          <path d="M9 20h6"/>
          <path d="M12 4v16"/>
        </svg>
      </button>
    </div>
  </div>

  <!-- Minimap -->
  <div class="minimap" id="minimap">
    <div class="minimap__header">
      <span class="minimap__title">Overview</span>
      <button class="minimap__toggle" id="minimap-toggle" title="Collapse">
        <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="6 9 12 15 18 9"/>
        </svg>
      </button>
    </div>
    <canvas id="minimap-canvas" width="180" height="120"></canvas>
    <div class="minimap__viewport" id="minimap-viewport"></div>
  </div>

  <!-- Node detail sidebar -->
  <aside class="sidebar" id="node-sidebar" hidden>
    <button class="sidebar__close" id="close-sidebar" aria-label="Close">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="18" y1="6" x2="6" y2="18"/>
        <line x1="6" y1="6" x2="18" y2="18"/>
      </svg>
    </button>

    <header class="sidebar__header">
      <span class="sidebar__badge" id="sidebar-type">NOTE</span>
      <h2 class="sidebar__title" id="sidebar-title">—</h2>
      <p class="sidebar__path" id="sidebar-path">—</p>
    </header>

    <!-- Note preview -->
    <div class="sidebar__preview" id="sidebar-preview">
      <p class="sidebar__preview-text" id="sidebar-preview-text"></p>
    </div>

    <!-- Connection stats -->
    <div class="sidebar__stats">
      <div class="sidebar__stat">
        <span class="sidebar__stat-icon">←</span>
        <span class="sidebar__stat-value" id="backlinks-count">0</span>
        <span class="sidebar__stat-label">inbound</span>
      </div>
      <div class="sidebar__stat">
        <span class="sidebar__stat-icon">→</span>
        <span class="sidebar__stat-value" id="forwardlinks-count">0</span>
        <span class="sidebar__stat-label">outbound</span>
      </div>
    </div>

    <div class="sidebar__section">
      <h3 class="sidebar__section-title">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="15 18 9 12 15 6"/>
        </svg>
        Backlinks
      </h3>
      <ul class="sidebar__list" id="backlinks-list"></ul>
    </div>

    <div class="sidebar__section">
      <h3 class="sidebar__section-title">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="9 18 15 12 9 6"/>
        </svg>
        Forward Links
      </h3>
      <ul class="sidebar__list" id="forwardlinks-list"></ul>
    </div>

    <!-- Dangling node action - Create Note button -->
    <div class="sidebar__action" id="sidebar-create-note" hidden>
      <button class="sidebar__create-btn" id="create-note-btn">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 5v14M5 12h14"/>
        </svg>
        <span data-i18n="create_note_btn">Create note from this concept</span>
      </button>
      <p class="sidebar__create-hint" data-i18n="create_note_hint">Click to copy GigaMind command to clipboard</p>
    </div>
  </aside>

  <!-- Focus mode indicator -->
  <div class="focus-bar" id="focus-indicator" hidden>
    <div class="focus-bar__content">
      <span class="focus-bar__icon">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"/>
          <circle cx="12" cy="12" r="3"/>
        </svg>
      </span>
      <span class="focus-bar__label">Focus Mode</span>
      <span class="focus-bar__node" id="focus-node-name">—</span>
    </div>
    <button class="focus-bar__exit" id="exit-focus">
      Exit <kbd>ESC</kbd>
    </button>
  </div>

  <!-- Load More bar for progressive loading -->
  <div class="load-more-bar" id="load-more-bar" hidden>
    <span class="load-more-bar__progress" id="load-progress-text">Showing 0 of 0 nodes</span>
    <div class="load-more-bar__actions">
      <button class="load-more-bar__btn load-more-bar__btn--secondary" id="load-more-btn">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="6 9 12 15 18 9"/>
        </svg>
        Load More
      </button>
      <button class="load-more-bar__btn load-more-bar__btn--primary" id="load-all-btn">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"/>
          <line x1="12" y1="8" x2="12" y2="16"/>
          <line x1="8" y1="12" x2="16" y2="12"/>
        </svg>
        Load Full Graph
      </button>
    </div>
  </div>

  <!-- Enhanced tooltip -->
  <div class="tooltip" id="tooltip" role="tooltip" hidden>
    <div class="tooltip__title" id="tooltip-title"></div>
    <div class="tooltip__meta" id="tooltip-meta"></div>
  </div>

  <!-- Loading state -->
  <div class="loading" id="loading">
    <div class="loading__content">
      <div class="loading__rings">
        <div class="loading__ring loading__ring--1"></div>
        <div class="loading__ring loading__ring--2"></div>
        <div class="loading__ring loading__ring--3"></div>
      </div>
      <span class="loading__text">Initializing neural graph...</span>
    </div>
  </div>

  <!-- Keyboard shortcuts help -->
  <div class="shortcuts-hint">
    <kbd>/</kbd> search
    <kbd>+</kbd><kbd>-</kbd> zoom
    <kbd>0</kbd> reset
    <kbd>ESC</kbd> exit
    <kbd>F</kbd> fullscreen
  </div>

  <!-- Toast notification -->
  <div class="toast" id="toast" hidden>
    <span class="toast__message" id="toast-message"></span>
  </div>

  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="js/graph.js"></script>
  <script src="js/controls.js"></script>
</body>
</html>
